@using CkanDotNet.Api.Model
@using CkanDotNet.Web.Models.Helpers
@using System.Text
@model Package

@{
    var formatTypes = CkanDotNet.Web.Models.Helpers.SettingsHelper.GetResourceSettings().Types;
}
<div class="package">

    @* Show the resources *@
    @if (Model.Resources.Count > 0)
    {
        <section class="container">
        <h2>Resources</h2>
        <table cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Format</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
            @foreach (Resource resource in Model.Resources)
            {
                <tr>
               
                    <td>
                        @resource.Description
                    </td>

                    <td>
                        @if (!formatTypes.ContainsKey(resource.Format))
                        {
                            <span class="format">@resource.Format</span>
                        }
                        else
                        {
                            <span class="tooltip format" title="@formatTypes[resource.Format].Title">@resource.Format</span>
                        }
                    
                    </td>

                    <td nowrap="nowrap">
                        @if (!formatTypes.ContainsKey(resource.Format))
                        {
                            <a href="@resource.Url" class="action">Download</a>
                        }
                        else
                        {
                            foreach (var action in formatTypes[resource.Format].Actions)
                            {
                                <a href="@action.BuildUrl(resource.Url)" class="action">@action.Action</a>
                            }
                        }
                    </td>
                </tr>
            }
            </tbody>
        </table>
        </section>
    }
    
    @* Show the details *@
    <section class="container">
    <h2>Details</h2>
    <table cellpadding="0" cellspacing="0">
        <tbody>
            <tr>
                <th>
                    Level of Government
                </th>
                <td>
                    @Model.Extras.LevelOfGovernment
                </td>
            </tr>
            <tr>
                <th>
                    Agency
                </th>
                <td>
                    @Model.Extras.Agency
                </td>
            </tr>
            <tr>
                <th>
                    Update Frequency
                </th>
                <td>
                    @Model.Extras.UpdateFrequency
                </td>
            </tr>
            <tr>
                <th>
                    Temporal Coverage
                </th>
                <td>
                    @if (@Model.Extras.TemporalCoverageFrom != null)
                    {
                        @Model.Extras.TemporalCoverageFrom @:to @Model.Extras.TemporalCoverageTo
                    }
                </td>
            </tr>
        </tbody>
    </table>
</section>

</div>
